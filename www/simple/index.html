<!-- index.html - Page principale du site du garagiste avec formulaires de prise et annulation de rendez-vous -->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <title>Tests Webserv</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <h1>Tests Webserv HTTP</h1>
    <p>Testez chaque type de requête HTTP grâce aux formulaires ci-dessous.</p>

     <!-- BLOC GET GROUP -->
    <section style="border: 2px solid #ccc; padding: 1rem; margin-bottom: 2rem; border-radius: 10px;">
        <h2>Tests GET - Global</h2>

        <!-- Fichier existant -->
        <form action="/fichier-existant.html" method="get">
            <h3>GET - Fichier existant</h3>
            <button type="submit">GET - Fichier existant</button>
        </form>

        <!-- Fichier inexistant -->
        <form action="/fichier-inexistant.html" method="get">
            <h3>GET - Fichier inexistant</h3>
            <button type="submit">GET - Fichier inexistant</button>
        </form>

        <!-- GET - Fichier binaire (image) -->
        <form action="/images/logo.jpg" method="get">
            <h3>Tester GET (image PNG)</h3>
            <button type="submit">Afficher l'image</button>
            <p>Ou voir directement <a href="/images/logo.jpg" target="_blank">ici</a></p>
        </form>

        <!-- Fichier sans droits -->
        <form action="/fichier-interdit.html" method="get">
            <h3>GET - Fichier sans droits</h3>
            <button type="submit">GET - Fichier sans droits</button>
        </form>
        
        <!-- Test GET interdit -->
        <form action="/no-method" method="get">
            <h3>GET - location interdite (/no-method)</h3>
            <button type="submit">Tester POST interdit</button>
        </form>

        <!-- Répertoire sans index, autoindex désactivé -->
        <form action="/sans-index/" method="get">
            <h3>GET - Répertoire sans index, autoindex désactivé</h3>
            <button type="submit">GET - Dossier sans index (autoindex OFF)</button>
        </form>

        <!-- Répertoire sans index, autoindex activé -->
        <form action="/avec-autoindex/" method="get">
            <h3>GET - Répertoire sans index, autoindex activé</h3>
            <button type="submit">GET - Dossier sans index (autoindex ON)</button>
        </form>

    </section>
















    <!-- POST -->
    <section style="border: 1px solid #ccc; padding: 1em; margin: 2em 0; border-radius: 8px;">
        <h2>Tests POST - Global</h2>

        <!-- Test POST simple -->
        <form action="/creer-fichier" method="post" style="margin-bottom: 1em;">
            <h3>POST - Création de fichier</h3>
            <label for="content1">Contenu à écrire :</label>
            <input type="text" id="content1" name="data" value="Hello, POST simple" required>
            <button type="submit">Envoyer POST</button>
        </form>

        <!-- Test POST multi formulaires -->
        <form action="/prendre-rendezvous" method="post">
            <h3>POST - Multi formulaire</h3>
            <label for="name">Nom :</label>
            <input type="text" id="name" name="name" required>

            <label for="date">Date :</label>
            <input type="date" id="date" name="date" required>

            <label for="time">Heure :</label>
            <input type="time" id="time" name="time" required>

            <button type="submit">Envoyer POST</button>
        </form>

        <!-- Test POST interdit -->
        <form action="/no-method" method="post">
            <h3>POST - location interdite (/no-post)</h3>
            <label for="forbidden-post">Contenu :</label>
            <input type="text" id="forbidden-post" name="data" value="test">
            <button type="submit">Tester POST interdit</button>
        </form>

        <!-- Upload de fichier (multipart/form-data) -->
        <form action="/upload" method="post" enctype="multipart/form-data">
            <h3>POST - Upload de Fichier</h3>
            <label for="file">Choisissez un fichier :</label>
            <input type="file" id="file" name="file" required>
            <button type="submit">Envoyer Fichier</button>
        </form>

        <form method="POST" enctype="multipart/form-data" action="/upload">
            <input type="file" name="file1">
            <input type="file" name="file2">
            <input type="file" name="file3">
            <input type="file" name="file4">
            <input type="file" name="file5">
            <button type="submit">Envoyer</button>
        </form>

    </section>






















    <!-- DELETE -->
    <section style="border: 1px solid #ccc; padding: 1em; margin: 2em 0; border-radius: 8px;">
        <h2>Tests DELETE - Global</h2>

        <!-- DELETE - Fichier autorisé -->
        <form action="delete_me.txt" method="post">
            <h3>DELETE - Fichier autorisé</h3>
            <input type="hidden" name="_method" value="DELETE">
            <button type="submit">Supprimer delete_me.txt</button>
        </form>

        <!-- DELETE - Fichier interdit -->
        <form action="/no-method" method="post">
            <h3>DELETE - Fichier interdit (/no-method)</h3>
            <input type="hidden" name="_method" value="DELETE">
            <button type="submit">Tester DELETE interdit</button>
        </form>

        <!-- DELETE - Fichier inexistant -->
        <form action="/fichiers/inexistant.txt" method="post">
            <h3>DELETE - Fichier inexistant</h3>
            <input type="hidden" name="_method" value="DELETE">
            <button type="submit">Supprimer inexistant.txt</button>
        </form>

        <!-- DELETE - Répertoire (sans slash) -->
        <form action="/delete" method="post">
            <h3>DELETE - Dossier (sans slash)</h3>
            <p>Supprime le dossier delete via DELETE <code>/delete</code></p>
            <input type="hidden" name="_method" value="DELETE">
            <button type="submit">Tester DELETE dossier (sans slash)</button>
        </form>

        <!-- DELETE - Répertoire (avec slash) -->
        <form action="/delete/" method="post">
            <h3>DELETE - Dossier (avec slash)</h3>
            <p>Supprime le dossier delete via DELETE <code>/delete/</code></p>
            <input type="hidden" name="_method" value="DELETE">
            <button type="submit">Tester DELETE dossier (avec slash)</button>
        </form>

    </section>












    <!-- BLOC Divers GROUP -->
    <section style="border: 2px solid #ccc; padding: 1rem; margin-bottom: 2rem; border-radius: 10px;">
        <h2>Tests Divers - Global</h2>
        
        <!-- Redirection -->
        <form action="/rediriger-moi" method="get">
            <h2>Tester Redirection</h2>
            <button type="submit">Tester 301</button>
        </form>
         
        <!-- Body Size -->
        <form action="/tiny-body" method="post">
            <h3>POST vers location avec `client_max_body_size 0`</h3>
            <label for="tiny-content">Texte à envoyer :</label>
            <input type="text" id="tiny-content" name="data" value="interdit">
            <button type="submit">Envoyer POST (devrait échouer)</button>
        </form>
            
        <!-- Non implementer -->
        </form>
            <h3>Test - Méthode HTTP non implémentée (ex: PATCH)</h3>
            <button onclick="testNotImplemented()">Tester PATCH (501)</button>
        </form>
        <script>
            function testNotImplemented() {
            fetch("/", {
                method: "PATCH"
            }).then(res => {
                document.getElementById("patch-result").textContent =
                `Status: ${res.status} ${res.statusText}`;
            }).catch(err => {
                document.getElementById("patch-result").textContent =
                `Erreur: ${err}`;
            });
            }
        </script>
    </section>

















    <!-- BLOC redirection GROUP -->
    <section style="border: 2px solid #ccc; padding: 1rem; margin-bottom: 2rem; border-radius: 10px;">
        <h2>Tests CGI - Global</h2>

        <!-- CGI - GET simple -->
        <form action="/cgi-bin/test_get.py" method="get">
            <h3>CGI - GET Simple</h3>
            <!-- <label for="user-get">Nom :</label>
            <input type="text" id="user-get" name="user" value="jean"> -->
            <button type="submit">Envoyer GET</button>
        </form>

        <!-- CGI - POST simple -->
        <form action="/cgi-bin/test_post.py" method="post">
            <h3>CGI - POST Simple</h3>
            <label for="user-post">Nom :</label>
            <input type="text" id="user-post" name="user" value="paul">
            <button type="submit">Envoyer POST</button>
        </form>

        <!-- CGI - Test timeout -->
        <form action="/cgi-bin/infinite_loop.py" method="get">
            <h3>CGI - Timeout (boucle infinie)</h3>
            <button type="submit">Lancer CGI infini</button>
        </form>

        <!-- CGI - Sortie malformée (pas de Content-Type) -->
        <form action="/cgi-bin/bad_output.py" method="get">
            <h3>CGI - Sortie invalide (sans header)</h3>
            <button type="submit">Lancer CGI incorrect</button>
        </form>

        <!-- CGI - Non exécutable -->
        <form action="/cgi-bin/forbidden_exec.py" method="get">
            <h3>CGI - Script non exécutable (403 attendu)</h3>
            <button type="submit">Lancer script non exécutable</button>
        </form>

        <!-- CGI - redirection -->
        <form action="/cgi-bin/redirect.py" method="get">
            <h3>CGI - Redirection (Location:)</h3>
            <button type="submit">Lancer CGI Redirection</button>
        </form>


    </section>
  
</body>
</html>
